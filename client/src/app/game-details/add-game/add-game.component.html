<p> League</p>
<mat-form-field>
  <mat-label>Select League</mat-label>
  <mat-select (selectionChange)="onLeagueChange($event.value)">
    @for (league of leagues; track league) {
      <mat-option [value]="league">{{league}}</mat-option>
    }
  </mat-select>
</mat-form-field>

<mat-divider></mat-divider>

<p> Team 1</p>
<form class="example-form">
  <mat-form-field class="example-full-width">
    <mat-label>Select Team 1</mat-label>
    <input type="text"
           placeholder="Pick one"
           aria-label="Team 1"
           matInput
           [formControl]="team1FormControl"
           [matAutocomplete]="auto1">
    <mat-autocomplete autoActiveFirstOption #auto1="matAutocomplete">
      @for (option1 of team1FilteredOptions | async; track option1) {
        <mat-option [value]="option1">{{option1}}</mat-option>
      }
    </mat-autocomplete>
  </mat-form-field>
</form>

<p> Team 2</p>
<form class="example-form">
  <mat-form-field class="example-full-width">
    <mat-label>Select Team 2</mat-label>
    <input type="text"
           placeholder="Pick one"
           aria-label="Team 2"
           matInput
           [formControl]="team2FormControl"
           [matAutocomplete]="auto2">
    <mat-autocomplete autoActiveFirstOption #auto2="matAutocomplete">
      @for (option2 of team2FilteredOptions | async; track option2) {
        <mat-option [value]="option2">{{option2}}</mat-option>
      }
    </mat-autocomplete>
  </mat-form-field>
</form>

<mat-divider></mat-divider>

<p> Stadium </p>
<mat-form-field>
  <mat-label>Select Stadium</mat-label>
  <mat-select
    [disabled]="!team1FormControl.value || !team2FormControl.value"
    (selectionChange)="onStadiumChange($event.value)">
    @for (stadium of stadiums; track stadium) {
      <mat-option [value]="stadium">{{stadium.name}}</mat-option>
    }
  </mat-select>
</mat-form-field>

<mat-divider></mat-divider>

<p> Date </p>
<mat-form-field>
  <mat-label>Choose a date</mat-label>
  <input
    matInput
    [matDatepicker]="picker"
    [formControl]="dateFormControl">
  <mat-hint>MM/DD/YYYY</mat-hint>
  <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
  <mat-datepicker #picker></mat-datepicker>
</mat-form-field>


<p> Broadcaster </p>
<mat-form-field>
  <mat-label>Broadcasters</mat-label>
  <mat-select [formControl]="broadcasterFormControl" multiple>
    <mat-select-trigger>
      {{broadcasterFormControl.value?.[0] || ''}}
      @if ((broadcasterFormControl.value?.length || 0) > 1) {
        <span class="example-additional-selection">
          (+{{(broadcasterFormControl.value?.length || 0) - 1}}
          {{broadcasterFormControl.value?.length === 2 ? 'other' : 'others'}})
        </span>
      }
    </mat-select-trigger>
    @for (broadcaster of broadcasters; track broadcaster) {
      <mat-option
        [value]="broadcaster.channel_name">
        {{broadcaster.channel_name}}</mat-option>
    }
  </mat-select>
</mat-form-field>

<p>Attendance</p>
<mat-form-field class="width: 50%">
  <mat-label>Enter fan attendance</mat-label>
  <input matInput [disabled]="!selectedStadium" type="number" [(ngModel)]="attendance">
  <mat-hint align="start">{{attendance}} / {{selectedStadium?.capacity}}</mat-hint>
</mat-form-field>

<mat-divider></mat-divider>
<button style="margin: 2rem;"
        [disabled]="!attendance"
        mat-flat-button (click)="showPlayerStats()">Add Player Stats</button>


@if (showStatTables) {
  <div class="stat-table-div">
    <div class="stat-table">
      <table mat-table [dataSource]="team1PlayerStats" class="mat-elevation-z8">
        <!-- Player Name Column -->
        <ng-container matColumnDef="player_id">
          <th mat-header-cell *matHeaderCellDef> Player Name </th>
          <td mat-cell *matCellDef="let stat"> {{ getPlayerName(stat.player_id, 'team1') }} </td>
        </ng-container>

        <!-- Goals Scored Column -->
        <ng-container matColumnDef="goals_scored">
          <th mat-header-cell *matHeaderCellDef> Goals Scored </th>
          <td mat-cell *matCellDef="let stat">
            <mat-form-field>
              <input matInput type="number" [(ngModel)]="stat.goals_scored" [min]="0">
            </mat-form-field>
          </td>
        </ng-container>

        <!-- Yellow Card Column -->
        <ng-container matColumnDef="yellow_card">
          <th mat-header-cell *matHeaderCellDef> Yellow Card </th>
          <td mat-cell *matCellDef="let stat">
            <mat-checkbox class="example-margin" [(ngModel)]="stat.yellow_card"/>
          </td>
        </ng-container>

        <!-- Red Card Column -->
        <ng-container matColumnDef="red_card">
          <th mat-header-cell *matHeaderCellDef> Red Card </th>
          <td mat-cell *matCellDef="let stat">
            <mat-checkbox class="example-margin" [(ngModel)]="stat.red_card"/>
          </td>
        </ng-container>

        <!-- Header Row -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <!-- Data Row -->
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>

    <div class="stat-table">
      <table mat-table [dataSource]="team2PlayerStats" class="mat-elevation-z8">
        <!-- Player Name Column -->
        <ng-container matColumnDef="player_id">
          <th mat-header-cell *matHeaderCellDef> Player Name </th>
          <td mat-cell *matCellDef="let stat"> {{ getPlayerName(stat.player_id, 'team2') }} </td>
        </ng-container>

        <!-- Goals Scored Column -->
        <ng-container matColumnDef="goals_scored">
          <th mat-header-cell *matHeaderCellDef> Goals Scored </th>
          <td mat-cell *matCellDef="let stat">
            <mat-form-field>
              <input matInput type="number" [(ngModel)]="stat.goals_scored" [min]="0">
            </mat-form-field>
          </td>
        </ng-container>

        <!-- Yellow Card Column -->
        <ng-container matColumnDef="yellow_card">
          <th mat-header-cell *matHeaderCellDef> Yellow Card </th>
          <td mat-cell *matCellDef="let stat">
            <mat-checkbox class="example-margin" [(ngModel)]="stat.yellow_card"/>
          </td>
        </ng-container>

        <!-- Red Card Column -->
        <ng-container matColumnDef="red_card">
          <th mat-header-cell *matHeaderCellDef> Red Card </th>
          <td mat-cell *matCellDef="let stat">
            <mat-checkbox class="example-margin" [(ngModel)]="stat.red_card"/>
          </td>
        </ng-container>

        <!-- Header Row -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <!-- Data Row -->
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>

  </div>
}



<mat-divider></mat-divider>
<button style="margin: 2rem;"
        [disabled]="!attendance"
        mat-flat-button (click)="submitPlayerStats()">Submit Details</button>

<div style="margin-top: 2rem;">
  Empty Bottom Margin
</div>
